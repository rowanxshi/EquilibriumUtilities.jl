<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>EquilibriumUtilities.jl Documentation · Equilibrium Utilities</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Equilibrium Utilities</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>EquilibriumUtilities.jl Documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>EquilibriumUtilities.jl Documentation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>EquilibriumUtilities.jl Documentation</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="EquilibriumUtilities.jl-Documentation"><a class="docs-heading-anchor" href="#EquilibriumUtilities.jl-Documentation">EquilibriumUtilities.jl Documentation</a><a id="EquilibriumUtilities.jl-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#EquilibriumUtilities.jl-Documentation" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.EquilibriumUtilities" href="#EquilibriumUtilities.EquilibriumUtilities"><code>EquilibriumUtilities.EquilibriumUtilities</code></a> — <span class="docstring-category">Module</span></header><section><div><p>A package of basic utility functions used commonly when computing economic equilibria.</p><p>See <a href="#EquilibriumUtilities.converge-Tuple{Function, Function, Function}"><code>converge</code></a>, <a href="#EquilibriumUtilities.normalise!"><code>normalise!</code></a>, <a href="#EquilibriumUtilities.zero_safe-Tuple{Any}"><code>zero_safe</code></a>, <a href="#EquilibriumUtilities.newton"><code>newton</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/EquilibriumUtilities.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.WrappedDict" href="#EquilibriumUtilities.WrappedDict"><code>EquilibriumUtilities.WrappedDict</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">abstract type WrappedDict{T} &lt;: AbstractDict{Symbol, T}</code></pre><p>Eases creating custom <code>struct</code>s that are basically dictionaries.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup> A concrete subtype of <code>WrappedDict</code> <em>must</em> have a field <code>internal_dict::Dict{Symbol, T}</code>, which is the dictionary.</p><p>For an example, see this package&#39;s tests with an implementation of a Pollak demand function <code>struct</code> as a <code>WrappedDict</code>.</p><p>See also <a href="#EquilibriumUtilities.validate-Tuple{Any, Any}"><code>validate</code></a>, <a href="#EquilibriumUtilities.pretty"><code>pretty</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/WrappedDict.jl#L18-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.converge-Tuple{Function, Function, Function}" href="#EquilibriumUtilities.converge-Tuple{Function, Function, Function}"><code>EquilibriumUtilities.converge</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">converge(update::Function, step_diff::Function, init::Function; kwargs...)</code></pre><p>Iterate until convergence. In particular, the problem is initiated with <code>init()</code>. Then, repeatedly apply <code>step_diff()</code> which should do an iteration step, then return the <code>diff</code>. <code>converge</code> will compare the returned difference with <code>tol</code>; if it&#39;s smaller, then converge is reached and iteration stops. Otherwise, it will apply <code>update()</code>, which should return the size of the update.</p><p>The function returns a pair of booleans, the first of which signals whether convergence was reached; the second signals whether iteration was aborted because the update was too small.</p><p>For an example, see this package&#39;s tests which uses this function to solve the finite-firm CES game.</p><p>See also <a href="#EquilibriumUtilities.update!-Tuple{Any, Any}"><code>update!</code></a>, <a href="#EquilibriumUtilities.dampen-Tuple{Any}"><code>dampen</code></a>, <a href="#EquilibriumUtilities.v_diff-Tuple{Any, Any}"><code>v_diff</code></a>.</p><p><strong>Keywords</strong></p><ul><li><code>diff_tol::Real = 1e-6</code> : If the value returned by <code>step_diff</code> is less than this tolerance, stop.</li><li><code>up_tol::Real = zero(diff_tol)</code> : If the value returned by <code>update</code> is less than this tolerance, stop.</li><li><code>max_iter::Integer = 200</code> : Maximum number of iterations before giving up.</li><li><code>msg = &quot;No convergence&quot;</code> : Warning message to display if there isn&#39;t convergence within the maximum number of iterations.</li><li><code>history = nothing</code> : Container in which to store the iteration history of <code>diff</code>s. Useful to check speed of convergence. If <code>nothing</code> is provided, saves no history.</li><li><code>verbose::Bool = false</code> : Print the <code>diff</code> every iteration?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L62-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.dampen-Tuple{Any}" href="#EquilibriumUtilities.dampen-Tuple{Any}"><code>EquilibriumUtilities.dampen</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dampen(history; kwargs...)</code></pre><p>Given an iteration <code>history</code>, return a dampening factor. At the moment, just uses the last value of <code>history</code>.</p><p><strong>Keywords</strong></p><ul><li><code>slow = 0.95</code> : the dampening factor for slow updating (when <code>diff</code> is above 10).</li><li><code>med = 0.75</code> : the dampening factor for medium updating (when <code>diff</code> is above 1).</li><li><code>fast = 0.5</code> : the dampening factor for fast updating.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L201-L210">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.dynamic_dampen-NTuple{7, Any}" href="#EquilibriumUtilities.dynamic_dampen-NTuple{7, Any}"><code>EquilibriumUtilities.dynamic_dampen</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">dynamic_dampen(dampen, last_loosened, last_tightened, reference_diff, last_devs, penultimate_devs, history; kw...)</code></pre><p>Update the dampening factor based on convergence path. Strategy:</p><ul><li>increase by <code>tighten</code> if <code>history</code> <a href="#EquilibriumUtilities.isdiverging-Tuple{Any}"><code>isdiverging</code></a> or <a href="#EquilibriumUtilities.isovershooting-Tuple{Any, Any}"><code>isovershooting</code></a></li><li>make no change if any of:</li></ul><pre><code class="nohighlight hljs">* within the first `grace_period` iterations
* it has been under `tighten_wait` iterations since the last tightening
* it has been under `loosen_wait` iterations since the last loosening
* the current difference is above `scale*reference_diff`
* the `tail` of `history` [`!isconvex`](@ref), with tolerance `convex_tol`</code></pre><ul><li>otherwise, decrease by <code>loosen</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L128-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.isconvex-Tuple{Any}" href="#EquilibriumUtilities.isconvex-Tuple{Any}"><code>EquilibriumUtilities.isconvex</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">	isconvex(history; tail = 25, tol = 0.005)</code></pre><p>Check if the last <code>tail</code> entries in <code>history</code> is convex. Useful for dynamically updating the dampening factory.</p><p>See also <a href="#EquilibriumUtilities.dynamic_dampen-NTuple{7, Any}"><code>dynamic_dampen</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L187-L193">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.isdiverging-Tuple{Any}" href="#EquilibriumUtilities.isdiverging-Tuple{Any}"><code>EquilibriumUtilities.isdiverging</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isdiverging(history)</code></pre><p>Checks if iteration is on a bad path, but seeing if two of the past 3 iterations have worsened the difference. Useful for dynamically updating the dampening factor.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><p>See also <a href="#EquilibriumUtilities.dynamic_dampen-NTuple{7, Any}"><code>dynamic_dampen</code></a>.</p><pre><code class="nohighlight hljs">[^1]: If updating is too aggressive, usually one of two things happens. Either the difference blows up (if updating is _too_ aggressive) or the difference oscillates between improving and worsening (if updating is a little too aggressive).</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L158-L166">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.isovershooting-Tuple{Any, Any}" href="#EquilibriumUtilities.isovershooting-Tuple{Any, Any}"><code>EquilibriumUtilities.isovershooting</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">isovershooting(last_dev, penultimate_dev; share = 0.5)</code></pre><p>Check if the convergence is overshooting each guess, as measured by a <code>share</code> of the deviations flipping signs between the last two iterations. Useful for dynamically updating the dampening factor.<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup></p><p>See also <a href="#EquilibriumUtilities.dynamic_dampen-NTuple{7, Any}"><code>dynamic_dampen</code></a>.</p><pre><code class="nohighlight hljs">[^1]: If dampening isn&#39;t strong enough, the devations alternate between positive and negative. Convergence wastes times bouncing back and forth, usually slowing down. Increasing the dampening can drastically speed up convergence by preventing this oscillation.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L172-L180">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.newton" href="#EquilibriumUtilities.newton"><code>EquilibriumUtilities.newton</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Simple Newton method implementation.</p><p><strong>Keywords</strong></p><ul><li><code>step_tol = 1e-8</code> : If the (absolute value of) step size is smaller than this tolerance, stop.</li><li><code>f_tol = step_tol</code> : If the (absolute value of) function value is smaller than this tolerance, stop.</li><li><code>max_iter = 750</code> : Maximum number of iterations before giving up.</li><li><code>l = -Inf</code> : Left bound.</li><li><code>r = Inf</code> : Right bound.</li><li><code>msg = &quot;No Newton convergence&quot;</code> : Warning message to display if there isn&#39;t convergence within the maximum number of iterations.</li><li><code>verbose::Bool = false</code> : Print some info every iteration?</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L1-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.newton-Tuple{Function, Any}" href="#EquilibriumUtilities.newton-Tuple{Function, Any}"><code>EquilibriumUtilities.newton</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">newton(f_f′, x; kwargs...)</code></pre><p><code>f_f′</code> should be a function which returns the tuple <code>(f, f′)</code> of function value and derivative. <code>x</code> is the initial guess.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.newton-Tuple{Function, Function, Real}" href="#EquilibriumUtilities.newton-Tuple{Function, Function, Real}"><code>EquilibriumUtilities.newton</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">newton(f, f′, x; kwargs...)</code></pre><p><code>f</code> should be a function which returns the function value and <code>f′</code> its derivative. <code>x</code> is the initial guess.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L50-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.normalise!" href="#EquilibriumUtilities.normalise!"><code>EquilibriumUtilities.normalise!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">normalise!(v, factor = zero_safe(first(v)))</code></pre><p>Normalise <code>v</code> by some <code>factor</code>. Useful for normalising nominal prices (so the first element is the numeraire) or shares (with <code>factor = sum(v)</code>).</p><p>See also <a href="#EquilibriumUtilities.zero_safe-Tuple{Any}"><code>zero_safe</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/EquilibriumUtilities.jl#L9-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.pretty" href="#EquilibriumUtilities.pretty"><code>EquilibriumUtilities.pretty</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">pretty(s::WrappedDict, var_names = keys(s); kw...)</code></pre><p>Return a string version of <code>s</code> for pretty-printing.</p><p><strong>Keywords</strong></p><ul><li><code>pad = 8</code>: column width</li><li><code>digits = 4</code>: number of digits to round to</li><li><code>spacer = 2</code>: number of spaces in between columns</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/WrappedDict.jl#L43-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.update!-Tuple{Any, Any}" href="#EquilibriumUtilities.update!-Tuple{Any, Any}"><code>EquilibriumUtilities.update!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">update!(main, secondary; dampen = 0.75, v_diff = v_diff)</code></pre><p>Update <code>main</code> according to <code>secondary</code>, with a <code>dampen</code>ing factor. Useful for iterative algorithms. Once complete, <code>main</code> will hold the updated value and <code>secondary</code> will hold main&#39;s original value (to keep a record of previous iteration). Returns the <code>v_diff</code> of the update step (useful for breaking iteration if the step size is too small).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L103-L107">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.v_diff-Tuple{Any, Any}" href="#EquilibriumUtilities.v_diff-Tuple{Any, Any}"><code>EquilibriumUtilities.v_diff</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">v_diff(v1, v2)</code></pre><p>Calculate the distance between two vectors as the sum of element-wise absolute difference.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/solvers.jl#L116-L120">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.validate-Tuple{Any, Any}" href="#EquilibriumUtilities.validate-Tuple{Any, Any}"><code>EquilibriumUtilities.validate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">validate(given, needed)</code></pre><p>For each key in <code>needed</code>, check that it&#39;s present in <code>given</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/WrappedDict.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="EquilibriumUtilities.zero_safe-Tuple{Any}" href="#EquilibriumUtilities.zero_safe-Tuple{Any}"><code>EquilibriumUtilities.zero_safe</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">zero_safe(x)</code></pre><p>If <code>x</code> is zero, return <code>one(x)</code>. Otherwise, return <code>x</code>. Useful for safely dividing by <code>x</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rowanxshi/EquilibriumUtilities.jl/blob/014b0ae94db6135733fdb0cdf23c0483901ec095/src/EquilibriumUtilities.jl#L19-L23">source</a></section></article><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>Essentially implements <code>keys</code>, <code>values</code>, <code>length</code>, <code>iterate</code>, <code>getindex</code>, <code>setindex!</code>, <code>get</code>, and <code>get!</code> by delegating to the necessary field <code>internal_dict</code>.</li></ul></section></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Sunday 12 March 2023 03:01">Sunday 12 March 2023</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
